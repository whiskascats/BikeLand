import{b as o,f as i,u as L,s as A,g as t,t as h,n as g,h as O,i as w,e as l,j as z,k as R,d as E,m as M,l as U,r as x,o as D,_ as Z,F as u,p,q as y,v as F,w as j,x as q,y as N,z as H,A as G,B as J,C as K,D as Q,c as B}from"./index-c90d5c55.js";const W={key:0,class:"btn btn-warn",type:"button"},X={key:1,class:"btn btn-trouble",type:"button"},Y={key:2,class:"btn btn-trouble",type:"button"},tt={key:3,class:"btn btn-none",type:"button"},et={__name:"parkingStatus",props:{item:{type:Object}},setup(a){return(c,m)=>(o(),i("div",null,[a.item.AvailableRentBikes>0&&a.item.AvailableReturnBikes>0?(o(),i("button",W,"可借可還")):a.item.AvailableRentBikes>0&&a.item.AvailableReturnBikes==0?(o(),i("button",X,"只可借車")):a.item.AvailableRentBikes==0&&a.item.AvailableReturnBikes>0?(o(),i("button",Y,"只可停車")):(o(),i("button",tt,"站點施工中"))]))}},st={class:"col-12 mb-3"},at={class:"col-12 d-flex justify-content-between mb-3"},nt=t("div",{class:"w-100"},[t("i",{class:"fa fa-bicycle"}),w(" 可租借 ")],-1),ot={class:"w-100 count"},it={class:"card-tab"},lt=t("div",{class:"w-100"},[t("i",{class:"fa fa-parking"}),w(" 可停車 ")],-1),ct={class:"w-100 count"},rt={class:"col-12 d-flex justify-content-between mb-3"},dt={class:"distance"},ut=t("i",{class:"fas fa-map-marker-alt"},null,-1),vt={__name:"card1",props:{item:{type:Object}},setup(a){const c=a,m=L(),{userLocation:r,chooseStation:b,chooseNearbyBikeDataList:k}=A(m),v=async()=>{b.value=c.item,R([c.item.StationPosition.PositionLat,c.item.StationPosition.PositionLon]);const $=await m.getNearbyBikeData(`${c.item.StationPosition.PositionLat},${c.item.StationPosition.PositionLon}`);$.map(d=>d.distance=E(r.value[0],r.value[1],d.StationPosition.PositionLat,d.StationPosition.PositionLon)),k.value=$,M(k.value,c.item)};return($,d)=>(o(),i("div",{class:"w-100 cards card1 d-flex flex-wrap",onClick:v},[t("h2",st,h(a.item.StationName.Zh_tw),1),t("div",at,[t("div",{class:g(["card-tab",a.item.AvailableRentBikes>5?"":a.item.AvailableRentBikes>0?"danger":"none"])},[nt,t("div",ot,h(a.item.AvailableRentBikes),1)],2),t("div",it,[lt,t("div",ct,h(a.item.AvailableReturnBikes),1)])]),t("div",rt,[O(et,{item:a.item},null,8,["item"]),t("div",dt,[ut,t("span",null,[w("距離"),t("span",null,h(l(z)(a.item.distance)),1)])])])]))}},mt={class:"w-100 cards card2 d-flex flex-wrap"},bt={class:"col-12 d-flex pb-3"},ft=t("div",{class:"col-1 card-tab-dot dot1"},null,-1),ht={class:"col-11 d-flex justify-content-between"},kt={class:"w-100 d-flex card-tabs"},yt=t("div",{class:"col-2 card-tab justify-content-center me-2"},"起",-1),_t={class:"col-10 card-tab justify-content-start ps-2"},gt={class:"col-12 d-flex pb-3"},$t=t("div",{class:"col-1 card-tab-dot dot2"},null,-1),xt={class:"col-11 d-flex justify-content-between"},pt={class:"w-100 d-flex card-tabs"},wt=t("div",{class:"col-2 card-tab justify-content-center me-2"},"迄",-1),St={class:"col-10 card-tab justify-content-start ps-2"},Ct={__name:"card2",props:{item:{type:Object}},setup(a){const c=a,m=()=>{U(c.item)};return(r,b)=>(o(),i("div",mt,[t("h2",{class:"col-12 mb-3",onClick:m},h(a.item.RouteName),1),t("div",bt,[ft,t("div",ht,[t("div",kt,[yt,t("div",_t,h(a.item.RoadSectionStart||"資料建置中"),1)])])]),t("div",gt,[$t,t("div",xt,[t("div",pt,[wt,t("div",St,h(a.item.RoadSectionEnd||"資料建置中"),1)])])])]))}},Bt={class:"col-12 d-flex"},Lt={class:"col-12 d-none d-lg-flex mb-2 tabs"},At={key:0,class:"oneline"},Rt={__name:"card3",props:{item:{type:Object}},setup(a){const c=a,m=L(),{chooseAttraction:r}=A(m),b=x();D(()=>{if(!Z.isEmpty(c.item.Picture)){const v=new Image;v.src=c.item.Picture.PictureUrl1,v.onload=function(){b.value.classList.remove("default"),b.value.style.backgroundImage=`url(${v.src})`,setTimeout(()=>{b.value.classList.add("has-img")},500)}}});const k=()=>{r.value=c.item,R([c.item.Position.PositionLat,c.item.Position.PositionLon],18),F(c.item.sid)};return(v,$)=>(o(),i("div",{class:"col-lg-12 col-md-5 col-12 cards card3 d-flex flex-wrap",onClick:k},[t("div",{class:"card3-img mt-lg-4 default",ref_key:"backgroundImage",ref:b,style:{}},null,512),t("div",Bt,[t("h2",{class:"col-12 my-2",onClick:k},h(a.item.ScenicSpotName),1)]),t("div",Lt,[(o(),i(u,null,p(5,d=>(o(),i(u,{key:d},[a.item["Class"+d]?(o(),i("span",At,h(a.item["Class"+d]),1)):y("",!0)],64))),64))])]))}},Pt={class:"sidebar d-flex flex-wrap align-content-start"},jt={class:"d-flex w-100 justify-content-between mb-3 flex-wrap"},Nt={class:"search col-lg-8 col-sm-10 col-8 mb-3"},Dt=t("i",{class:"fa-solid fa-chevron-down"},null,-1),Tt=t("option",{value:"",style:{display:"none"}},"請選擇縣市",-1),It=["value"],Vt={class:"sort col-lg-4 col-sm-2 col-4 d-flex mb-3 justify-content-center"},Ot={class:"search col-lg-8 col-sm-10 col-8"},zt=t("i",{class:"fa fa-search"},null,-1),Et={class:"d-flex w-100 card-section"},Mt={class:"top-icon"},Ut={key:0,class:"find-tab"},Zt={class:"col-12"},Ft=t("i",{class:"fas fa-bicycle"},null,-1),qt=t("span",{class:"d-none d-lg-block"},"找單車",-1),Ht=t("i",{class:"fas fa-umbrella-beach"},null,-1),Gt=t("span",{class:"d-none d-lg-block"},"找景點",-1),Jt=t("i",{class:"fas fa-parking"},null,-1),Kt=t("span",{class:"d-none d-lg-block"},"找車位",-1),Qt=t("i",{class:"fas fa-utensils"},null,-1),Wt=t("span",{class:"d-none d-lg-block"},"找餐廳",-1),Xt=["disabled"],Yt=t("i",{class:"fas fa-crosshairs fa-2x"},null,-1),te=[Yt],se={__name:"sidebar",props:{cardList:{type:Array,default:[]},tab:[String,Number]},emits:["changeCity","changeTab"],setup(a,{emit:c}){const m=a,r=Q(),b=L(),{userLocation:k,searchParams:v,cityDataList:$}=A(b),d=x(""),T=j(()=>{let n=$.value;return n=n.filter(e=>e.type.includes(r.name)),n}),C=j(()=>{let n=m.cardList;if(v.value.ks)switch(r.name){case"BikeStation":n=n.filter(e=>e.StationName.Zh_tw.includes(_.value)||e.StationAddress.Zh_tw.includes(_.value));break;case"BikeRoute":n=n.filter(e=>e.RouteName.includes(_.value));break;case"Attractions":n=n.filter(e=>e.ScenicSpotName.includes(_.value));break}if(d.value)switch(d.value){case"distance":n=n.sort((e,s)=>e.distance-s.distance);break;case"rent":n=n.sort((e,s)=>s.AvailableRentBikes-e.AvailableRentBikes);break;case"return":n=n.sort((e,s)=>s.AvailableReturnBikes-e.AvailableReturnBikes);break;case"short-length":n=n.sort((e,s)=>e.CyclingLength-s.CyclingLength);break;case"long-length":n=n.sort((e,s)=>s.CyclingLength-e.CyclingLength);break;default:n=n}return n}),_=x(""),f=x(!1),S=x("0px");D(async()=>{await b.getCityData(),v.value.city=""});const I=async n=>{c("changeCity",n)},P=n=>{c("changeTab",n)},V=()=>{if(!_.value)return!1;if(m.cardList.length<=0)return alert("請先搜尋縣市或是打開定位"),!1;v.value.ks=_.value};return q(()=>f.value,n=>{n?r.name==="Attractions"?S.value="40px":S.value="120px":S.value="0px"}),(n,e)=>(o(),i(u,null,[t("div",Pt,[t("div",jt,[t("div",Nt,[Dt,N(t("select",{class:"form-control search-button",onChange:e[0]||(e[0]=s=>I(s.target.value)),"onUpdate:modelValue":e[1]||(e[1]=s=>l(v).city=s)},[Tt,(o(!0),i(u,null,p(l(T),s=>(o(),i("option",{value:s.city_value,key:s.city_value},h(s.city_name),9,It))),128))],544),[[H,l(v).city]])]),t("div",Vt,[t("button",{type:"button",class:"btn btn-change",onClick:e[2]||(e[2]=s=>f.value=!f.value)},[t("i",{class:g(["fa",{"fa-arrow-up-wide-short":!f.value,"fa-arrow-down-wide-short":f.value}])},null,2),w(" 排序 ")]),t("div",{class:"sort-section",style:G({height:S.value})},[t("div",{class:"text-center",onClick:e[3]||(e[3]=s=>{d.value="distance",f.value=!1})},"距離較近"),l(r).name==="BikeStation"?(o(),i(u,{key:0},[t("div",{class:"text-center",onClick:e[4]||(e[4]=s=>{d.value="rent",f.value=!1})},"可借車數"),t("div",{class:"text-center",onClick:e[5]||(e[5]=s=>{d.value="return",f.value=!1})},"可還車數")],64)):y("",!0),l(r).name==="BikeRoute"?(o(),i(u,{key:1},[t("div",{class:"text-center",onClick:e[6]||(e[6]=s=>{d.value="short-length",f.value=!1})},"路線短到長"),t("div",{class:"text-center",onClick:e[7]||(e[7]=s=>{d.value="long-length",f.value=!1})},"路線長到短")],64)):y("",!0)],4)]),t("div",Ot,[N(t("input",{id:"search-button",placeholder:"搜尋站點或路名",type:"text",class:"form-control search-button","onUpdate:modelValue":e[8]||(e[8]=s=>_.value=s)},null,512),[[J,_.value,void 0,{trim:!0}]])]),t("div",{class:"col-lg-4 col-sm-2 col-4 d-flex justify-content-center"},[t("button",{type:"button",class:"btn btn-change",onClick:V},[zt,w(" 搜尋 ")])])]),t("div",Et,[t("div",{class:g(["w-100 card-list pe-3",{Attractions:l(r).name==="Attractions"}])},[l(r).name==="BikeStation"?(o(!0),i(u,{key:0},p(l(C),s=>(o(),B(vt,{key:s.StationID,item:s},null,8,["item"]))),128)):l(r).name==="BikeRoute"?(o(!0),i(u,{key:1},p(l(C),s=>(o(),B(Ct,{key:s.RouteName,item:s},null,8,["item"]))),128)):l(r).name==="Attractions"?(o(!0),i(u,{key:2},p(l(C),s=>(o(),B(Rt,{key:s.ScenicSpotID,item:s},null,8,["item"]))),128)):y("",!0)],2)])]),t("div",Mt,[a.tab!=0?(o(),i("div",Ut,[t("span",{class:g(["cover",{active:a.tab==2}])},null,2),t("div",Zt,[t("div",{class:g(["col-6 cover-tabs",{active:a.tab==1}]),onClick:e[9]||(e[9]=s=>P(1))},[l(r).name==="BikeStation"?(o(),i(u,{key:0},[Ft,qt],64)):y("",!0),l(r).name==="Attractions"?(o(),i(u,{key:1},[Ht,Gt],64)):y("",!0)],2),t("div",{class:g(["col-6 cover-tabs",{active:a.tab==2}]),onClick:e[10]||(e[10]=s=>P(2))},[l(r).name==="BikeStation"?(o(),i(u,{key:0},[Jt,Kt],64)):y("",!0),l(r).name==="Attractions"?(o(),i(u,{key:1},[Qt,Wt],64)):y("",!0)],2)])])):y("",!0),t("div",null,[t("button",{type:"button",class:g(["locate-icon",{"none-locate":l(k).length==0}]),onClick:e[11]||(e[11]=s=>{l(R)(l(k)),l(K)()}),disabled:l(k).length==0},te,10,Xt)])])],64))}};export{se as _};
